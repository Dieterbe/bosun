"use strict";angular.module("ui.codemirror",[]).constant("uiCodemirrorConfig",{}).directive("uiCodemirror",["uiCodemirrorConfig",function(e){return{restrict:"EA",require:"?ngModel",priority:1,compile:function(n){if(angular.isUndefined(window.CodeMirror)){throw new Error("ui-codemirror need CodeMirror to work... (o rly?)")}var r=n.text();var i=new window.CodeMirror(function(e){angular.forEach(n.prop("attributes"),function(t){if(t.name==="ui-codemirror"){e.setAttribute("ui-codemirror-opts",t.textContent)}else{e.setAttribute(t.name,t.textContent)}});if(n.parent().length<=0){n.wrap("<div>")}n.replaceWith(e)},{value:r});return function(n,r,s,o){function f(e){for(var t in e){if(e.hasOwnProperty(t)){i.setOption(t,e[t])}}}var u,a;u=e.codemirror||{};a=angular.extend({},u,n.$eval(s.uiCodemirror),n.$eval(s.uiCodemirrorOpts));f(a);if(angular.isDefined(n.$eval(s.uiCodemirror))){n.$watch(s.uiCodemirror,f,true)}i.on("change",function(e){var t=e.getValue();if(o&&t!==o.$viewValue){o.$setViewValue(t)}if(!n.$$phase){n.$apply()}});if(o){o.$formatters.push(function(e){if(angular.isUndefined(e)||e===null){return""}else if(angular.isObject(e)||angular.isArray(e)){throw new Error("ui-codemirror cannot use an object or an array as a model")}return e});o.$render=function(){var e=o.$viewValue||"";i.setValue(e)}}if(s.uiRefresh){n.$watch(s.uiRefresh,function(e,t){if(e!==t){i.refresh()}})}if(angular.isFunction(a.onLoad)){a.onLoad(i)}}}}}])